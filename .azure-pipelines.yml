#
# Azure Pipelines configuration for building and testing urllib3 on Linux, Windows, and macOS.
#

trigger:
- master

jobs:
- job: Mac
  displayName: 'Mac'
  pool:
    vmImage: 'macOS-10.13'
  strategy:
    matrix:
      Python27:
        PYTHON_VERSION: '2.7'
        TOXENV: 'py27'
      Python34:
        PYTHON_VERSION: '3.4'
        TOXENV: 'py34'
      Python35:
        PYTHON_VERSION: '3.5'
        TOXENV: 'py35'
      Python36:
        PYTHON_VERSION: '3.6'
        TOXENV: 'py36'
      Python37:
        PYTHON_VERSION: '3.7'
        TOXENV: 'py37'
  steps:
    - task: UsePythonVersion@0
      inputs:
        versionSpec: '$(PYTHON_VERSION)'
        architecture: 'x64'
      displayName: 'Install Python'
    - script: env
    - script: openssl version
    - script: python -c "import ssl; print(ssl.OPENSSL_VERSION)"
    - script: ./_travis/install.sh
      displayName: 'install'
    - script: ./_travis/run.sh
      displayName: 'run'
    - script: ./_travis/upload_coverage.sh
      displayName: 'upload coverage -- need condition if succeed'

variables:
  GAE_SDK_PATH: ${HOME}/.cache/google_appengine
  PYTHONWARNINGS: always::DeprecationWarning
  PYPI_USERNAME: urllib3
# PYPI_PASSWORD is set in Travis control panel.